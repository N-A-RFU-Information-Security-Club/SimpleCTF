# debug a bug

Прежде всего закинем файл в **DetectItEasy** или с помощью команды **file** посмотрим что же это вообще за файл.
<image src="/Reverse/debug_a_bug/files/1.png" alt="">

То что нам важно - это часть строки с указанием библиотеки .NET. Учитывая что категория таска - Reverse, то попробуем декомпилировать программу.
P.S. Не всегда декомпиляция может дать результаты, но в случае если она будет успешна, то вы увидите исходный код. Успех зависит от параметров, выбранных её разработчиком при публикации/компиляции.

Будем декомпилировать, но возникает вопрос: **"Как?"**
Мы знаем что использована библиотека .NET, а значит будем искать декомпилторы именно для .NET.
Первой же ссылкой при поиске выдаёт бесплатный инструмент dotPeek, также если поскать на других сайтах, форумах и т.д. то можно найти dnSpy, который я и буду использовать далее.
На самом деле программы почти ничем не отличаются и обе подходят для решения задания.

Теперь наконец кидаем файл в программу и смотрим.
Если получилось что-то похожее, то всё успешно, идём смотреть исходный код.
<image src="/Reverse/debug_a_bug/files/2.png" alt="">

Найти сам код можно и руками, ползая по обозревателю, но для удобства и быстроты можно нажать на **Program** в строке **Точка входа**.
Вот и сам код, смотрим, анализируем.
<image src="/Reverse/debug_a_bug/files/3.png" alt="">

Проанализировав код можно увидеть функцию сравнения строк, которая судя по всему используется для проверки корректности пароля, функцию Decrypt, которая выведет нам флаг в понятном виде, а также основную функцию Main.
В функции Main видим строку s в которой находится нужный нам пароль, а также замечаем ошибку в коде.
<image src="/Reverse/debug_a_bug/files/4.png" alt="">

Есть два условия if, первое проверяет корректность введённого пароля, а так как пароль мы знаем, то можем не беспокоиться, а второе условие проверяет равенство числа 375 и переменной num, которая равна 43.
Отсюда следует что нам нужно поменять значение переменной num на 375 или изменить число в условии на 43, после чего снова скомпилировать программу, запустить её, ввести ранее найденый пароль и получить флаг.

Нажимаем **ПКМ** где-нибудь в функции **Main** и нажимаем **Изменить метод (C#)**
<image src="/Reverse/debug_a_bug/files/5.png" alt="">

Изменям значение, в примере я изменял значение переменной, после чего нажимаем кнопку компилировать. Также если вы будете запускать программу просто двойным кликом, а не через powershell или cmd, то стоит добавить ожидание ввода в конец функции, чтобы можно было скопировать флаг и программа не закрылась сразу после выполнения.
<image src="/Reverse/debug_a_bug/files/6.png" alt="">

Далее всё что нам остаётся это нажать кнопку **Файл**, выбрать пункт **Сохранить модуль** и нажать **ОК**.
Затем запускаем программу и вводим пароль.
<image src="/Reverse/debug_a_bug/files/7.png" alt="">

Флаг: SimpleCTF{N@r3ver$1l_n@_g0s1zm3ny}

P.S. Ссылка на плейлист по dnSpy и .NET: https://youtube.com/playlist?list=PLf5wwHGjuyZ369gJCn52T3alavlCokALR&si=_Q_jNbzBFs7u4P98 
